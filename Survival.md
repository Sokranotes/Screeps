# Survival

çŽ©åˆ°åŽé¢ï¼Œæµè§ˆå™¨ç–¯ç‹‚alt+1 alt+2 alt+3åˆ‡æ¢ï¼Œæ— æ³•åœæ­¢ï¼ŒF5ä¸€æŒ‰å›žåˆ°è§£æ”¾å‰ï¼Œç›´æŽ¥å†³å®šä¸ç­‰åŠä»·äº†ã€‚

### å·²ç»å®Œæˆçš„å·¥ä½œï¼š

- è§£å†³Harvesterä¸º0æ—¶ï¼ŒHarvesteræ— æ³•ç”Ÿæˆçš„é—®é¢˜
  - åŽŸå› ï¼šnewNameæ²¡å£°æ˜Ž

### éœ€è¦å®Œå–„çš„å·¥ä½œï¼š

##### è¿‘æœŸ


- ç»„ä»¶éšå¯ç”¨èƒ½æºå’Œæ€»èƒ½æºå®¹é‡è¿›è¡Œå˜åŒ–ï¼Œä»£ç ä¼˜åŒ–
- é˜²å¾¡çš„å»ºç«‹
- æŽ§åˆ¶å™¨å‡çº§ç›¸å…³
- èƒ½æºç‚¹èƒ½æºè€—å°½çš„é—®é¢˜
- é‡‡é›†èµ„æºå’Œå…¶ä»–ä»»åŠ¡è§£è€¦

##### é•¿è¿œ

- ä»»åŠ¡é©±åŠ¨è®¾è®¡æ¨¡å¼
- ç»„ä»¶è‡ªåŠ¨è°ƒæ•´åŠŸèƒ½å®Œå–„
- é—²ç½®è§’è‰²æ”¹å˜è§’è‰²å®Œå–„
- å¯»æ‰¾æ›´è¿‘ä¸”é—²ç½®çš„èƒ½æºç‚¹
- æ ¹æ®å·¥ä½œé‡è¿›è¡ŒæŽ§åˆ¶creepçš„ç”Ÿæˆ
- é˜²å¾¡çš„è‡ªåŠ¨ç»´æŠ¤
- æ”»å‡»éƒ¨é˜Ÿç”Ÿæˆ

#### ä¿¡æ¯ï¼š

##### å»ºé€ å¯¹åº”éƒ¨ä»¶æ‰€éœ€èƒ½é‡

[WORK] 100

[CARRY] 50

[MOVE] 50

[WORK, CARRY, MOVE] 200

[WORK, WORK, CARRY, MOVE] 300

extension 3000

è·¯ 300

### ç§»åŠ¨ï¼š

é™¤äº† `MOVE` å¤–ï¼Œ Creep çš„æ¯ä¸€ä¸ªæž„é€ éƒ¨ä»¶éƒ½æœ‰é‡é‡ï¼šå¸¦çš„éƒ¨ä»¶è¶Šå¤šï¼Œç§»åŠ¨é€Ÿåº¦è¶Šæ…¢ã€‚æ¯ä¸ªéƒ¨ä»¶ï¼ˆé™¤äº† `MOVE`ï¼‰éƒ½éƒ½ä¼šäº§ç”Ÿç–²åŠ³å€¼ï¼šåœ¨é“è·¯ä¸Šä¸º 1 ç‚¹ï¼Œå¹³åŽŸä¸Šä¸º 2 ç‚¹ï¼Œæ²¼æ³½é‡Œä¸º 10 ç‚¹ã€‚æ¯ä¸€ä¸ª MOVE éƒ¨ä»¶æ¯ä¸ªæ¸¸æˆ tick ä¼šå‡å°‘ 2 ç‚¹ç–²åŠ³å€¼ï¼Œå½“ Creep çš„ç–²åŠ³å€¼å¤§äºŽ 0 æ—¶æ— æ³•ç§»åŠ¨ã€‚

> å¦‚æžœè¦ä¿è¯ Creep æ¯ä¸ªæ¸¸æˆ tick èƒ½ç§»åŠ¨ä¸€æ ¼ï¼Œéœ€è¦è®¡ç®—é™¤ `MOVE` å¤–çš„æ‰€æœ‰éƒ¨ä»¶çš„ç–²åŠ³å€¼æ€»å’Œå¹¶ä½¿ `MOVE` å‡å°‘çš„ç–²åŠ³å€¼ä¸ä½ŽäºŽè¿™ä¸ªæ€»å’Œã€‚

æ¢å¥è¯è¯´ï¼Œä¸€ä¸ª `MOVE` éƒ¨ä»¶åœ¨æ¯ä¸ª tick å¯ä»¥ç§»åŠ¨å…¶ä»–éƒ¨ä»¶ä¸€ä¸ªæ–¹æ ¼ã€‚å¦‚æžœä¸€ä¸ª Creep çš„ `MOVE` éƒ¨ä»¶ä¸è¶³ï¼Œä»–çš„ç§»åŠ¨åŠ›ä¼šæŒ‰æ¯”ä¾‹å‡é€Ÿï¼Œè¿™å¯ä»¥é€šè¿‡ç–²åŠ³åº¦æ¥çœ‹å‡ºã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ²¡æœ‰æ¬è¿èµ„æºçš„ `CARRY` éƒ¨ä»¶æ˜¯ä¸ä¼šäº§ç”Ÿç–²åŠ³çš„ã€‚

å‡ ä¸ªå°ä¾‹å­ï¼š

- Creep `[CARRY, WORK, MOVE]` åœ¨æ²¡æœ‰æ¬è¿èƒ½é‡çš„æ—¶å€™ä¸€ä¸ª tick å¯ä»¥è·‘ 1 æ ¼ï¼Œæ¬äº†èƒ½é‡ä»¥åŽ 2 ä¸ª tick æ‰èƒ½è·‘ 1 æ ¼ã€‚
- Creep `[TOUGH, ATTACK, ATTACK, MOVE, MOVE, MOVE]` å°†ä»¥æ»¡é€Ÿï¼ˆ1 ä¸ª tick ä¸€æ ¼ï¼‰è¡ŒåŠ¨ã€‚
- Creep `[TOUGH, ATTACK, ATTACK, MOVE, MOVE]` æ ¹æ®å‘ä¸Šå–æ•´åŽŸåˆ™ 2 ä¸ª tick ç§»åŠ¨ 1 æ ¼ã€‚

### æ‰‹åŠ¨survivalä»£ç 

##### main

```javascript
var roleHarvester = require('role.harvester');
var roleUpgrader = require('role.upgrader');
var roleBuilder = require('role.builder');
var roleRepairer = require('role.repairer');
var harvestersNum = 3;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ;
var upgradersNum = 4;
var repairersNum = 0;
var buildersNum = 4;
module.exports.loop = function () {
    // console.log(Game.spawns['Spawn1'].room.energyAvailable)
    // console.log(Game.rooms['sim'].name)
    // console.log(Game.rooms['sim'].energyAvailable)
    
    // console.log(Math.random())

    for(var name in Memory.creeps) {
        if(!Game.creeps[name]) {
            delete Memory.creeps[name];
            console.log('Clearing non-existing creep memory:', name);
        }
    }
    
    var ec = Game.rooms['sim'].energyCapacityAvailable;
    // console.log(ec);
    var harvesters = _.filter(Game.creeps, (creep) => creep.memory.role == 'harvester');
    // console.log(harvesters.length);
    // console.log(harvesters.length < harvestersNum);
    if (harvesters.length == 0){
        var newName = 'Harvester' + Game.time;
        console.log(Game.rooms['sim'].energyAvailable);
        // console.log(parseInt(ec/100)*100);
        // console.log(Game.rooms['sim'].energyAvailable <= parseInt(ec/100)*100);
        if (Game.rooms['sim'].energyAvailable >= 600){
            Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'harvester'}});
            console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE: ' + newName);
        }
        else if (Game.rooms['sim'].energyAvailable >= 500){
            Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'harvester'}});
            console.log('Spawning new harvester WORK, WORK, WORK, WORK, CARRY, MOVE: ' + newName);
        }
        
        else if (Game.rooms['sim'].energyAvailable >= 400){
            Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'harvester'}});
            console.log('Spawning new harvester WORK, WORK, WORK, CARRY, MOVE: ' + newName);
        }
        else{
            Game.spawns['Spawn1'].spawnCreep([WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'harvester'}});
            console.log('Spawning new harvester WORK, WORK, CARRY, MOVE: ' + newName);
        }
    }
    // console.log('energyAvailable:' + Game.rooms['sim'].energyAvailable + " energyCapacityAvailable:" + parseInt(ec/100)*100);
    // console.log(Game.rooms['sim'].energyAvailable + " " + parseInt(ec/100)*100);
    if (Game.rooms['sim'].energyAvailable >= parseInt(ec/100)*100){
        console.log('energy full');
        
        console.log('Harvesters: ' + harvesters.length);
        // console.log(harvesters.length);
        // console.log(harvestersNum);
        // console.log(harvesters.length < harvestersNum);
        
        var upgrader = _.filter(Game.creeps, (creep) => creep.memory.role == 'upgrader');
        console.log('Upgraders: ' + upgrader.length);
        
        var repairer = _.filter(Game.creeps, (creep) => creep.memory.role == 'repairer');
        console.log('Repairer: ' + repairer.length);
        
        var builder = _.filter(Game.creeps, (creep) => creep.memory.role == 'builder');
        console.log('Builders: ' + builder.length);
        
        if (Game.spawns['Spawn1'].spawning){
            console.log('spawning');
        }
        else if(harvesters.length < harvestersNum) {
            var newName = 'Harvester' + Game.time;
            // console.log(Game.time);
            // console.log(newName);
            // console.log(parseInt(ec/100)*100);
            // console.log(parseInt(ec/100)*100 == 300);
            // console.log(parseInt(ec/100)*100 == 400);
            // console.log(parseInt(ec/100)*100 == 500);
            if (parseInt(ec/100)*100 == 300){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'harvester'}});
                console.log('Spawning new harvester WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (parseInt(ec/100)*100 == 400){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'harvester'}});
                console.log('Spawning new harvester WORK, WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (parseInt(ec/100)*100 == 500){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'harvester'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (parseInt(ec/100)*100 == 600){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'harvester'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable == 650){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE], newName, {memory: {role: 'harvester'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable == 700){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE], newName, {memory: {role: 'harvester'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable == 750){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE], newName, {memory: {role: 'harvester'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable >= 800){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE, MOVE], newName, {memory: {role: 'harvester'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE, MOVE: ' + newName);
            }
        }
        else if(upgrader.length < upgradersNum) {
            var newName = 'Upgrader' + Game.time;
            var sou = 0;
            if (Math.random() < 0.75){
                sou = 0;
            }
            else{
                sou = 3;
            }
            if (parseInt(ec/100)*100 == 300){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'upgrader', source: sou}});
                console.log('Spawning new upgrader WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (parseInt(ec/100)*100 == 400){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'upgrader', source: sou}});
                console.log('Spawning new upgrader WORK, WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (parseInt(ec/100)*100 == 500){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'upgrader', source: sou}});
                console.log('Spawning new upgrader WORK, WORK, WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (parseInt(ec/100)*100 >= 600){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'upgrader', source: sou}});
                console.log('Spawning new upgrader WORK, WORK, WORK, WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable == 650){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE], newName, {memory: {role: 'upgrader', source: sou}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable == 700){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE], newName, {memory: {role: 'upgrader', source: sou}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable == 750){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE], newName, {memory: {role: 'upgrader', source: sou}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable >= 800){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE, MOVE], newName, {memory: {role: 'upgrader', source: sou}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE, MOVE: ' + newName);
            }
        }
        else if(repairer.length < repairersNum) {
            var newName = 'Repairer' + Game.time;
            if (parseInt(ec/100)*100 == 300){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'repairer'}});
                console.log('Spawning new builder WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (parseInt(ec/100)*100 == 400){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'repairer'}});
                console.log('Spawning new builder WORK, WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (parseInt(ec/100)*100 == 500){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'repairer'}});
                console.log('Spawning new builder WORK, WORK, WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (parseInt(ec/100)*100 == 600){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'repairer'}});
                console.log('Spawning new builder WORK, WORK, WORK, WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable == 650){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE], newName, {memory: {role: 'repairer'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable == 700){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE], newName, {memory: {role: 'repairer'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable == 750){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE], newName, {memory: {role: 'repairer'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable >= 800){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE, MOVE], newName, {memory: {role: 'repairer'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE, MOVE: ' + newName);
            }
        }else if(builder.length < buildersNum) {
            var newName = 'Builder' + Game.time;
            if (parseInt(ec/100)*100 == 300){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'builder'}});
                console.log('Spawning new builder WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (parseInt(ec/100)*100 == 400){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'builder'}});
                console.log('Spawning new builder WORK, WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (parseInt(ec/100)*100 == 500){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'builder'}});
                console.log('Spawning new builder WORK, WORK, WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (parseInt(ec/100)*100 == 600){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE], newName, {memory: {role: 'builder'}});
                console.log('Spawning new builder WORK, WORK, WORK, WORK, WORK, CARRY, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable == 650){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE], newName, {memory: {role: 'builder'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable == 700){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE], newName, {memory: {role: 'builder'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable == 750){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE], newName, {memory: {role: 'builder'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE: ' + newName);
            }
            else if (Game.rooms['sim'].energyAvailable >= 800){
                Game.spawns['Spawn1'].spawnCreep([WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE, MOVE], newName, {memory: {role: 'builder'}});
                console.log('Spawning new harvester WORK, WORK, WORK, WORK, WORK, CARRY, MOVE, MOVE, MOVE, MOVE, MOVE: ' + newName);
            }
        }
    }
    
    if(Game.spawns['Spawn1'].spawning) { 
        var spawningCreep = Game.creeps[Game.spawns['Spawn1'].spawning.name];
        Game.spawns['Spawn1'].room.visual.text(
            'ðŸ› ï¸' + spawningCreep.memory.role,
            Game.spawns['Spawn1'].pos.x + 1, 
            Game.spawns['Spawn1'].pos.y, 
            {align: 'left', opacity: 0.8});
    }

    for(var name in Game.creeps) {
        var creep = Game.creeps[name];
        if(creep.memory.role == 'harvester') {
            roleHarvester.run(creep);
        }
        if(creep.memory.role == 'upgrader') {
            roleUpgrader.run(creep);
        }
        if(creep.memory.role == 'repairer') {
            roleRepairer.run(creep);
        }
        if(creep.memory.role == 'builder') {
            roleBuilder.run(creep);
        }
    }
}

```

##### role.builder

```javascript
var roleBuilder = {

    /** @param {Creep} creep **/
    run: function(creep) {
	    if(creep.memory.building && creep.store[RESOURCE_ENERGY] == 0) {
            creep.memory.building = false;
            creep.say('ðŸ”„ harvest');
	    }
	    if(!creep.memory.building && creep.store.getFreeCapacity() == 0) {
	        creep.memory.building = true;
	        creep.say('ðŸš§ build');
	    }

	    if(creep.memory.building) {
	        var targets = creep.room.find(FIND_CONSTRUCTION_SITES);
            if(targets.length) {
                if(creep.build(targets[0]) == ERR_NOT_IN_RANGE) {
                    creep.moveTo(targets[0], {visualizePathStyle: {stroke: '#ffffff'}});
                }
            }
	    }
	    else {
	       // var targets = creep.room.find(FIND_STRUCTURES, {
        //         filter: (structure) => {
        //             // return (structure.structureType == STRUCTURE_CONTAINER) && structure.store.getUsedCapacity(RESOURCE_ENERGY) > 0;//è¿‡æ»¤å™¨æ‰¾åˆ°éžç©ºçš„å»ºç­‘
        //             return (structure.structureType == STRUCTURE_CONTAINER);//è¿‡æ»¤å™¨æ‰¾åˆ°éžç©ºçš„å»ºç­‘
        //         }
        //     });
        //     if(targets.length > 0) {
        //         if(creep.withdraw(targets[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {
        //             creep.moveTo(targets[0], {visualizePathStyle: {stroke: '#ffffff'}});
        //         }
        //     }
        //     else{
        //         // creep.moveTo(Game.spawns['Spawn1'], {visualizePathStyle: {stroke: '#ffffff'}});
        //         creep.moveTo(new RoomPosition(23, 26, 'sim'), {visualizePathStyle: {stroke: '#ffffff'}});
        //     }
            
            var sources = creep.room.find(FIND_SOURCES);
            if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
                creep.moveTo(sources[0], {visualizePathStyle: {stroke: '#ffaa00'}});
            }
            else{
                creep.moveTo(Game.spawns['Spawn1'], {visualizePathStyle: {stroke: '#ffffff'}});
            }
	    }
	}
};

module.exports = roleBuilder;
```

##### role.harvester

```javascript
var roleHarvester = {

    /** @param {Creep} creep **/
    run: function(creep) {
	    if(creep.store.getFreeCapacity() > 0) {
	    // if(creep.memory.source == 0) {
            var sources = creep.room.find(FIND_SOURCES);
            if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
                creep.moveTo(sources[0], {visualizePathStyle: {stroke: '#ffaa00'}});//æ˜¾ç¤ºè·¯å¾„
            }
        }
        else {
            var targets = creep.room.find(FIND_STRUCTURES, {
                    filter: (structure) => {
                        return (structure.structureType == STRUCTURE_EXTENSION ||
                                structure.structureType == STRUCTURE_SPAWN ||
                                structure.structureType == STRUCTURE_TOWER ||
                                structure.structureType == STRUCTURE_CONTAINER) &&
                            structure.store.getFreeCapacity(RESOURCE_ENERGY) > 0;//è¿‡æ»¤å™¨æ‰¾åˆ°extensionæˆ–spawnç±»åž‹ä¸”ç©ºé—´æœªæ»¡çš„å»ºç­‘
                    }
            });
            if(targets.length > 0) {
                if(creep.transfer(targets[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {
                    creep.moveTo(targets[0], {visualizePathStyle: {stroke: '#ffffff'}});
                }
            }
            else{
                creep.moveTo(Game.spawns['Spawn1'], {visualizePathStyle: {stroke: '#ffffff'}});
            }
        }
	}
};

module.exports = roleHarvester;

```

##### role.upgrader

```javascript
var roleUpgrader = {

    /** @param {Creep} creep **/
    run: function(creep) {
	   // if(creep.store[RESOURCE_ENERGY] != creep.store.getCapacity()) {
	   // if(creep.store[RESOURCE_ENERGY] == 0) {
	   if (creep.store.getFreeCapacity() > 0){
            var sources = creep.room.find(FIND_SOURCES);
            // if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
            //     creep.moveTo(sources[0]);
            // }
            if (creep.memory.source == 0){
                if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
                    creep.moveTo(sources[0]);
                }
            }
            else{
                if(creep.harvest(sources[3]) == ERR_NOT_IN_RANGE) {
                    creep.moveTo(sources[3]);
                }
            }
        }
        else {
            if(creep.upgradeController(creep.room.controller) == ERR_NOT_IN_RANGE) {//è·ç¦»å¤Ÿåˆ™å‡çº§æŽ§åˆ¶å™¨
                creep.moveTo(creep.room.controller);
            }
        }
	}
};

module.exports = roleUpgrader;

```

##### role.repairer

```
var roleRepairer = {

    /** @param {Creep} creep **/
    run: function(creep){
        if(creep.memory.building && creep.store[RESOURCE_ENERGY] == 0) {
            creep.memory.building = false;
            creep.say('ðŸ”„ harvest');
        }
        if(!creep.memory.building && creep.store.getFreeCapacity() == 0) {
            creep.memory.building = true;
            creep.say('ðŸš§ repair');
        }

        if(creep.memory.building) {
            var target = creep.pos.findClosestByPath(FIND_STRUCTURES, {
                filter: (s) => s.hits < s.hitsMax && s.structureType != STRUCTURE_WALL
            });
            if(target) {
                if(creep.repair(target) == ERR_NOT_IN_RANGE) {
                    creep.moveTo(target, {visualizePathStyle: {stroke: '#ffffff'}});
                }
            }
            // else{
            //     creep.memory.role = 'builder';
            // }
        }
        else {
            var source = creep.pos.findClosestByPath(FIND_SOURCES);
            if(source && creep.harvest(source) == ERR_NOT_IN_RANGE) {
                creep.moveTo(source, {visualizePathStyle: {stroke: '#ffaa00'}});
            }
        }
    }
};

module.exports = roleRepairer;

```

### reference

[Screeps Survival](https://screeps.com/a/#!/sim/survival)

[Screeps Tutorial](https://screeps.com/a/#!/sim/tutorial)

[Screepsä¸­æ–‡æ–‡æ¡£ Creeps](https://screeps-cn.github.io/creeps.html)